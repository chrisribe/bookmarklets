javascript:!function(){"use strict";async function t(t,e=300){t.click(),await delay(e)}function e(t,e=5e3){return new Promise((o,n)=>{const i=document.querySelector(t);if(i)return void o(i);const c=new MutationObserver(()=>{const e=document.querySelector(t);e&&(c.disconnect(),o(e))});c.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{c.disconnect(),n(new Error(`Timeout waiting for element: ${t}`))},e)})}!async function(){try{console.log("Starting IcM child link workflow..."),console.log("1. Clicking Links button...");const o=Array.from(document.querySelectorAll("span.ms-Button-label")),n=o.find(t=>"Links"===t.textContent.trim());if(!n)throw console.error("Available button labels:",o.map(t=>t.textContent)),new Error("Links button not found");await t(n,500),console.log("2. Clicking Child tab...");const i=Array.from(document.querySelectorAll("span.ms-Pivot-text"));console.log("Available pivot tabs:",i.map(t=>t.textContent));const c=i.find(t=>t.textContent.match(/Child\s*\(/i));if(!c)throw new Error("Child tab not found");await t(c,300),console.log("3. Clicking Add link button..."),await new Promise(t=>setTimeout(t,300));const r=Array.from(document.querySelectorAll("span.ms-Button-label")).find(t=>t.textContent.includes("Add link"));if(!r)throw new Error("Add link button not found");await t(r,800),console.log("4. Focusing search box and pasting...");const l=await e('input.ms-SearchBox-field[placeholder*="Search incident"]',3e3);l.focus();const s=await navigator.clipboard.readText();l.value=s,l.dispatchEvent(new Event("input",{bubbles:!0})),l.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",bubbles:!0})),console.log("Pasted:",s),console.log("5. Waiting for search results..."),await new Promise(t=>setTimeout(t,2e3));const a=await e('input[type="checkbox"]',8e3);a&&!a.checked&&(a.click(),console.log("✓ Checkbox selected")),console.log("6. Clicking Next button..."),await new Promise(t=>setTimeout(t,300));const u=Array.from(document.querySelectorAll("button span.ms-Button-label")).find(t=>"Next"===t.textContent.trim());if(!u)throw new Error("Next button not found");u.closest("button").click(),console.log("✓ Next button clicked"),console.log("✓ Workflow complete! Ready to confirm link.")}catch(t){console.error("❌ Error:",t.message),alert("IcM Link Error: "+t.message)}}()}();